<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
<meta charset="UTF-8">
<title>Grocery God</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family:system-ui,Arial,sans-serif;
  background:#f9fafb;
  margin:0;
  padding:1rem;
}
h1{font-size:1.8rem;margin-bottom:1rem;text-align:center;color:#28a745;}
h2{font-size:1.4rem;margin:1.5rem 0 .5rem;color:#333;border-bottom:2px solid #eee;padding-bottom:0.25rem;}
.grid{display:grid;}
.gap-4{gap:1rem;}

/* Responsive grid */
@media (min-width: 480px) {
  .grid { grid-template-columns: repeat(2, 1fr); }
}
@media (min-width: 768px) {
  .grid { grid-template-columns: repeat(3, 1fr); }
}
@media (min-width: 1024px) {
  .grid { grid-template-columns: repeat(4, 1fr); }
}

/* ---------- Popout Menu ---------- */
.menu-toggle {
  display: flex;
  align-items: center;
  justify-content: left;
  margin-bottom: 1.1rem;
}

.menu-toggle button {
  background: #28a745;
  border: none;
  border-radius: .4rem;
  color: #fff;
  font-size: 1.3rem;
  padding: 0.4rem 0.7rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0,0,0,.06);
}

.menu-toggle button:active,
.menu-toggle button:focus {
  background: #218838;
  outline: 2px solid #8fd19e;
}

.menu-modal {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.15);
  display: none;
  justify-content: center;
  align-items: start;
  z-index: 150;
}

.menu-modal.show {
  display: flex;
  animation: fadein 0.17s;
}
@keyframes fadein {
  from { opacity: 0;}
  to { opacity: 1;}
}

/* Style the actual menu panel */
.menu {
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: .4rem;
  padding: .7rem;
  margin-top: 4rem;
  display: flex;
  flex-direction: column;
  gap: .75rem;
  box-shadow: 0 8px 16px rgba(0,0,0,.12), 0 1px 3px rgba(0,0,0,.05);
  min-width: 210px;
  position: relative;
}

.menu a {
  display: inline-block;
  padding: .45rem 1rem;
  border-radius: .4rem;
  border: 1px solid #28a745;
  background: #fff;
  color: #28a745;
  text-decoration: none;
  font-weight: 500;
  transition: all .15s ease;
  font-size: 1.1rem;
}
.menu a:hover {
  background: #28a745;
  color: #fff;
}

.menu .close-menu {
  position: absolute;
  top: .5rem;
  right: .7rem;
  background: none;
  border: none;
  font-size: 1.5rem;
  color: #666;
  cursor: pointer;
  padding: 0 0.4rem;
  z-index: 10;
}

/* Hide old menu layout in regular flow */
.menu-static {
  display: none !important;
}

/* ---------- Card ---------- */
/* ... rest of original styles ... (unchanged) ... */

.recipe-card{
  position:relative;
  border-radius:.5rem;
  overflow:hidden;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
  background: #fff;
  transition:transform .15s ease,box-shadow .15s ease;
}
/* [remaining styling omitted for brevity; same as the original] */

</style>
</head>
<body>

<h1>Fix Your Grocery List!</h1>

<!-- Popout menu toggle -->
<div class="menu-toggle">
  <button id="open-menu" aria-controls="menu-modal" aria-label="Open menu">
    &#9776; Menu
  </button>
</div>

<!-- Popout Menu modal overlay -->
<div id="menu-modal" class="menu-modal" role="dialog" aria-modal="true" tabindex="-1">
  <nav class="menu" aria-label="Recipe categories">
    <button class="close-menu" id="close-menu" aria-label="Close menu">&times;</button>
    <a href="#section-beef" class="menu-link">Beef</a>
    <a href="#section-chicken" class="menu-link">Chicken</a>
    <a href="#section-pork" class="menu-link">Pork</a>
    <a href="#section-veggie" class="menu-link">Veggie</a>
    <a href="#section-fast/easy" class="menu-link">Fast/Easy</a>
  </nav>
</div>

<!-- If you ever want a static menu still, add:
<nav class="menu-static">
  ... (links as above) ...
</nav>
-->

<div id="gallery"></div>
<div style="margin-top:1.5rem;">
  <button id="make-list" class="btn btn-primary" disabled>
    Get Shopping List (<span id="count">0</span>)
  </button>
</div>

<!-- Ingredient Modal -->
<div id="modal" class="modal">
  <div class="dialog">
    <button class="close">&times;</button>
    <h2 id="modal-title"></h2>
    <img id="modal-image" src="" alt="" style="width:100%; height:auto; max-height: 200px; object-fit: cover; border-radius: 0.3rem; margin-bottom: 1rem;">
    <ul id="modal-body"></ul>
    <div id="modal-actions" style="margin-top:1rem;text-align:right;"></div>
  </div>
</div>

<!-- Image Modal -->
<div id="image-modal" class="modal">
  <div class="dialog">
    <button class="close">&times;</button>
    <img id="image-modal-src" src="" alt="Full-size recipe image">
  </div>
</div>

<!-- Recipe Links -->
<section id="recipe-links">
  <h2>Recipe Links</h2>
  <ol id="recipe-links-list"></ol>
</section>

<script>
// ======= Popout menu toggle logic =======
function openMenu() {
  var modal = document.getElementById('menu-modal');
  modal.classList.add('show');
  modal.focus();
}

function closeMenu() {
  document.getElementById('menu-modal').classList.remove('show');
}

document.getElementById('open-menu').onclick = openMenu;
document.getElementById('close-menu').onclick = closeMenu;

document.getElementById('menu-modal').onclick = function(e) {
  // Only close when clicking the background (not inside the menu nav).
  if (e.target === this) closeMenu();
};

// Allow menu links to close menu when clicked
document.querySelectorAll('.menu-link').forEach(function(link){
  link.onclick = function() {
    closeMenu();
    // (let anchor navigation happen)
  };
});

// Optionally close menu with Escape key
document.getElementById('menu-modal').addEventListener('keydown', function(e){
  if (e.key === "Escape") closeMenu();
});

// ========== The rest of your original JS is unchanged below ===========

function roundAmount(unit, amount) {
  if (!unit) return Math.ceil(amount);
  var u = unit.toLowerCase();
  if (u === 'g' || u === 'kg') return Math.ceil(amount / 50) * 50;
  if (u === 'ml' || u === 'l') return Math.ceil(amount / 100) * 100;
  if (u === 'tbsp' || u === 'tsp' || u === 'cup') return Math.ceil(amount);
  return Math.ceil(amount);
}

// [recipes array, and all recipe logic unchanged ...]
// [gallery, modals, etc. ... unchanged from your file]

var recipes = [
  // ... as in your file
];

var selected = {};
var tileCounter = 1;

// Ingredient Modal
var modal = document.getElementById('modal');
var modalTitle = document.getElementById('modal-title');
var modalImage = document.getElementById('modal-image'); // Get modal image element
var modalBody = document.getElementById('modal-body');
var modalActions = document.getElementById('modal-actions');

document.querySelector('#modal .close').onclick = function () {
  modal.className = 'modal';
};
modal.onclick = function (e) {
  if (e.target === modal) { modal.className = 'modal'; }
};

// --- Image Modal Logic ---
// ... as before ...

function renderGallery() {
  // ... unchanged ...
}

function renderRecipeLinks() {
  // ... unchanged ...
}

function toggleSelect(id, element) {
  // ... unchanged ...
}

function openIngredientModal(recipe) {
  // ... unchanged ...
}

function buildShoppingList() {
  // ... unchanged ...
}

document.getElementById('make-list').onclick = buildShoppingList;

// Initial render
renderGallery();
renderRecipeLinks();
</script>
</body>
</html>
